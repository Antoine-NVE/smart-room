@startuml SmartRoom_Components_Diagram
title SmartRoom - Diagramme de composants

' ==== Acteurs externes ====
actor "Visiteur\n(non connecté)" as Visiteur
actor "Utilisateur\n(connecté)" as User
actor "Administrateur" as Admin
actor "Service Mail" as MailActor

' ==== Couche présentation ====
package "Couche présentation" {
  [Application Web\nSmartRoom] as WebApp
  [Module Authentification\n& Gestion de session] as AuthModule
}

' ==== Backend métier ====
package "Backend SmartRoom" {

  [API REST SmartRoom] as Api

  package "Services" {
    [Service Consultation\nSalles] as ConsultationSvc
    [Service Réservation] as ReservationSvc
    [Service Gestion des salles] as RoomMgmtSvc
    [Service Signalements] as ReportSvc
    [Service Statistiques\nOccupation] as StatsSvc
  }
  [Service Notification] as NotifSvc

}

' ==== Données & systèmes externes ====
database "SmartRoomDB" as DB
cloud "Serveur de mail\n(SMTP, Exchange, ...)" as MailServer

' ==== Interactions acteurs -> UI ====
Visiteur --> WebApp : consulter\nles salles
User --> WebApp : réserver,\nconsulter historique
Admin --> WebApp : administration

MailActor --> NotifSvc : (optionnel)\nretours de mail

' ==== Interactions UI -> Backend ====
WebApp --> AuthModule : login / logout\n(via API REST)
WebApp --> Api : appels REST\n(JSON, HTTPS)

' ==== API REST : vérification de l'accès ====
Api --> AuthModule : Vérification\nd'identité & rôles
AuthModule --> DB : utilisateurs,\nrôles, permissions

' ==== API -> Services métier (seulement si autorisé) ====
Api --> ConsultationSvc : /rooms
Api --> ReservationSvc : /reservations
Api --> RoomMgmtSvc : /admin/rooms
Api --> ReportSvc : /reports
Api --> StatsSvc : /admin/stats

' ==== Services métier -> Données ====
Services --> DB

' ==== Notifications ====
ReservationSvc --> NotifSvc : évènements\n(réservation, annulation,\nindisponibilité)
RoomMgmtSvc --> NotifSvc : fermeture / ouverture\nsalles
ReportSvc --> NotifSvc : nouveau signalement

NotifSvc --> MailServer : envoi d'e-mails\n(confirmation, modification,\nannulation, signalement)

@enduml
