@startuml SmartRoom_UseCase_Diagram
title SmartRoom – Diagramme des cas d'utilisation (exigences fonctionnelles colorées)

left to right direction
skinparam actorStyle awesome
skinparam usecase {
  BackgroundColor White
  BorderColor #555
  BorderThickness 1
}

'=== Définition des couleurs ===
!define COLOR_VISITOR #CFE2FF
!define COLOR_USER #D1E7DD
!define COLOR_ADMIN #FFE5B4
!define COLOR_TECH #E9ECEF

'=== Acteurs ===
actor "Visiteur\n(non connecté)" as Visiteur <<acteur>>
actor "Utilisateur\n(connecté)" as Utilisateur <<acteur>>
actor "Administrateur" as Admin <<acteur>>
actor "Service Mail" as Mail <<acteur>>

Utilisateur --|> Visiteur
Admin --|> Utilisateur

rectangle "SmartRoom" {

  package "Consultation (Public)" as P_Consult {
    usecase "Consulter la liste des salles" as UC_Browse COLOR_VISITOR
    usecase "Rechercher une salle" as UC_Search COLOR_VISITOR
    usecase "Afficher les disponibilités\n(planning, calendrier)" as UC_Schedule COLOR_VISITOR
    usecase "Consulter les détails d'une salle\n(capacité, équipements, localisation)" as UC_Detail COLOR_VISITOR
  }
  Visiteur --> P_Consult

  package "Réservations\n[Précondition: Authentification requise]" as P_Resa {
    usecase "Créer une réservation\nsimple" as UC_BookSimple COLOR_USER
    usecase "Créer une réservation\nrécurrente" as UC_BookRecur COLOR_USER
    usecase "Modifier une réservation existante" as UC_EditOwn COLOR_USER
    usecase "Annuler une réservation" as UC_CancelOwn COLOR_USER
    usecase "Consulter l’historique\nde ses réservations" as UC_History COLOR_USER
    usecase "Ajouter une salle aux favoris" as UC_AddFav COLOR_USER
    usecase "Retirer une salle des favoris" as UC_RemoveFav COLOR_USER
    usecase "Afficher le nom du réservataire\nd’une salle occupée" as UC_SeeHolder COLOR_USER
    usecase "Signaler un problème sur une salle\nou un équipement" as UC_Report COLOR_USER
  }
    Utilisateur --> P_Resa
  

  package "Gestion des salles\n" as P_Gest {
    usecase "Créer une nouvelle salle" as UC_CreateRoom COLOR_ADMIN
    usecase "Modifier les informations d’une salle" as UC_EditRoom COLOR_ADMIN
    usecase "Supprimer une salle" as UC_DeleteRoom COLOR_ADMIN
    usecase "Rendre une salle indisponible\n(travaux, maintenance)" as UC_Block COLOR_ADMIN
    usecase "Rendre une salle disponible à nouveau" as UC_Unblock COLOR_ADMIN
    usecase "Consulter toutes les réservations" as UC_ViewAll COLOR_ADMIN
    usecase "Modifier ou annuler une réservation\nquelconque" as UC_AdminEdit COLOR_ADMIN
    usecase "Consulter les signalements reçus" as UC_ViewReports COLOR_ADMIN
    usecase "Mettre à jour l’état d’un signalement\n(en cours / traité)" as UC_HandleReports COLOR_ADMIN
    usecase "Consulter les statistiques\nd’occupation des salles" as UC_Stats COLOR_ADMIN
  }
  Admin --> P_Gest

  '=== Notifications automatiques ===
  usecase "Notifier par e-mail\n(confirmation, modification, annulation,\nindisponibilité, signalement)" as UC_Email COLOR_TECH
  Mail <-- UC_Email

  UC_BookSimple ..> UC_Email : <<inclut>>
  UC_BookRecur  ..> UC_Email : <<inclut>>
  UC_EditOwn    ..> UC_Email : <<inclut>>
  UC_CancelOwn  ..> UC_Email : <<inclut>>
  UC_Block      ..> UC_Email : <<inclut>>\n(annulations automatiques)
  UC_Report     ..> UC_Email : <<inclut>>\n(notification administrateur)
}

@enduml
